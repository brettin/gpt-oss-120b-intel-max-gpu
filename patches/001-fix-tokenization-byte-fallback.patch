diff --git a/src/llama-vocab.cpp b/src/llama-vocab.cpp
index da938af0..ab0e6555 100644
--- a/src/llama-vocab.cpp
+++ b/src/llama-vocab.cpp
@@ -3305,17 +3305,30 @@ llama_token llama_vocab::byte_to_token(uint8_t ch) const {
             }
             // Try to fall back to just the byte as a string
             const char buf2[2] = { (char)ch, 0 };
-            return pimpl->token_to_id.at(buf2);
+            auto token2 = pimpl->token_to_id.find(buf2);
+            if (token2 != pimpl->token_to_id.end()) {
+                return (*token2).second;
+            }
+            // If byte token not found, use unknown token
+            return pimpl->special_unk_id;
         }
         case LLAMA_VOCAB_TYPE_WPM:
         case LLAMA_VOCAB_TYPE_BPE: {
-            return pimpl->token_to_id.at(unicode_byte_to_utf8(ch));
+            auto token = pimpl->token_to_id.find(unicode_byte_to_utf8(ch));
+            if (token != pimpl->token_to_id.end()) {
+                return (*token).second;
+            }
+            return pimpl->special_unk_id;
         }
         case LLAMA_VOCAB_TYPE_PLAMO2: {
             // PLaMo-2 uses byte tokens in format <0xXX>
             char hex_str[8];
             snprintf(hex_str, sizeof(hex_str), "<0x%02X>", ch);
-            return pimpl->token_to_id.at(hex_str);
+            auto token = pimpl->token_to_id.find(hex_str);
+            if (token != pimpl->token_to_id.end()) {
+                return (*token).second;
+            }
+            return pimpl->special_unk_id;
         }
         default:
             GGML_ABORT("fatal error");
